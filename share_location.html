<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<title>Share Location</title>
<style>
  :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  body { margin: 0; padding: 24px; background:#f9fafb; color:#111; }
  .card { max-width: 500px; margin: 0 auto; background: #fff; border-radius: 16px;
          box-shadow: 0 6px 24px rgba(0,0,0,.08); padding: 32px 24px; text-align:center; }
  h1 { font-size: 24px; margin-bottom: 8px; }
  p { color:#555; font-size:15px; margin-bottom:20px; }
  .status { margin-bottom: 16px; font-size:14px; color:#444; }
  button.primary { display:block; width:100%; padding:18px; font-size:18px; font-weight:600;
                   border:0; border-radius: 12px; background:#25D366; color:#fff; cursor:pointer; }
  button.primary:disabled { background:#a7d8bb; cursor: not-allowed; }
  .foot { margin-top:16px; font-size:12px; color:#777; }
</style>
</head>
<body>
  <div class='card'>
    <h1>✅ Share Location</h1>
    <p>Press the button to send your current location via WhatsApp.</p>
    <div class='status' id='status'>Waiting for location permission…</div>
    <button class='primary' id='sendBtn' disabled>Send Location</button>
    <div class='foot'>This will open WhatsApp with your location ready to send.</div>
  </div>

<script>
(function() {
  const sendBtn = document.getElementById('sendBtn');
  const statusBox = document.getElementById('status');
  const HARDCODED_NUMBER = "919740096978"; // your number

  let coords=null, accuracy=null, stamp=null;

  function updateStatus(text){ statusBox.textContent=text; }
  function pad(n){ return (n<10?'0':'')+n; }
  function formatDate(d){ return d.getFullYear()+"-"+pad(d.getMonth()+1)+"-"+pad(d.getDate())+" "+pad(d.getHours())+":"+pad(d.getMinutes()); }

  function requestLocation(){
    updateStatus("📡 Getting location… please allow GPS.");
    if(!navigator.geolocation){ updateStatus("❌ Geolocation not supported."); return; }
    navigator.geolocation.getCurrentPosition(function(pos){
      coords={lat:pos.coords.latitude.toFixed(6), lon:pos.coords.longitude.toFixed(6)};
      accuracy=Math.round(pos.coords.accuracy); 
      stamp=new Date();
      updateStatus("✔️ Location ready.");
      sendBtn.disabled=false;
    }, function(err){ updateStatus("❌ Could not get location: "+err.message); },
    {enableHighAccuracy:true, timeout:15000, maximumAge:0});
  }

  function openWhatsApp(){
    if(!coords){ alert("Location not ready yet."); return; }
    const msg=`✅ I'm safe\n🕰 ${formatDate(stamp)}\n📍 https://maps.google.com/?q=${coords.lat},${coords.lon}`;
    const url='https://wa.me/'+HARDCODED_NUMBER+'?text='+encodeURIComponent(msg);
    location.href=url;
  }

  sendBtn.addEventListener('click', openWhatsApp);
  requestLocation();
})();
</script>
</body>
</html>
